{
    "name": "empresas",
    "query": [
        "SELECT ARE_ESP_SECUE,",
        "ARE_ESP_NOMBRE,",
        "SERVICIO,",
        "CASE WHEN ID_MERCADO IS NOT NULL THEN ID_MERCADO ELSE 0 END,",
        "CASE WHEN NOM_MERCADO IS NOT NULL THEN NOM_MERCADO ELSE '0' END ",
        "FROM",
        "(",
        "(",
        " SELECT EMPRESAS.ARE_ESP_SECUE,",
        "        EMPRESAS.ARE_ESP_NOMBRE,",
        "        EMPRESAS.SERVICIO,",
        "        MERCADOS.ID_MERCADO,",
        "        MERCADOS.NOM_MERCADO ",
        " FROM ",
        " (",
        "     (",
        "         SELECT DISTINCT EMP.ARE_ESP_SECUE,",
        "                EMP.ARE_ESP_NOMBRE,",
        "                'ENERGIA' SERVICIO ",
        "         FROM ",
        "               RUPS.ARE_ESP_EMPRESAS EMP,",
        "               RUPS.ARE_SEES_SERESP ROM,",
        "               RUPS.ARE_NESP_NATESP NES,",
        "               RUPS.ARE_ACES_ACTESP ACT ",
        "         WHERE ",
        "               ROM.ARE_ESP_SECUE = EMP.ARE_ESP_SECUE",
        "               AND ROM.ARE_ESP_SECUE = NES.ARE_ESP_SECUE",
        "               AND ROM.ARE_ESP_SECUE = ACT.ARE_ESP_SECUE",
        "               AND EMP.ARE_ESP_SECUE < 99900",
        "               AND ROM.ARE_SEES_ESTADO = 'O'",
        "               AND NES.ARE_NESP_ESTADO = 'O'",
        "               AND ACT.ARE_ACES_ESTADO = 'O'",
        "               AND EMP.ARE_ESP_ACTUALIZA IS NOT NULL",
        "               AND EMP.ARE_ESP_ESTACT = 'A'",
        "               AND EMP.ARE_ESP_SECUE_CREG <> 0 ",
        "         GROUP BY ",
        "                  EMP.ARE_ESP_SECUE,",
        "                  EMP.ARE_ESP_NOMBRE,",
        "                  EMP.ARE_ESP_ACTUALIZA,",
        "                  EMP.ARE_ESP_ESTACT,",
        "                  EMP.ARE_ESP_SECUE_CREG ",
        "     )",
        "     UNION ",
        "     (",
        "         SELECT ARE_ESP_SECUE,",
        "                ARE_ESP_NOMBRE,",
        "                'ENERGIA' SERVICIO ",
        "         FROM ",
        "             RUPS.ARE_ESP_EMPRESAS",
        "         WHERE ARE_ESP_SECUE = 44278 ",
        "     )",
        " ) EMPRESAS,",
        " (",
        "     SELECT ",
        "         DISTINCT ID_MERCADO,",
        "         ARE_ESP_SECUE,",
        "         NOM_MERCADO,",
        "         ESTADO ",
        "     FROM ",
        "         CARG_COMERCIAL_E.MERCADO_EMPRESA ",
        "     WHERE ",
        "         ID_MERCADO = :MERCADO_ARG OR 0 = :MERCADO_ARG ",
        "         AND ESTADO = 'A'",
        "         AND NOM_MERCADO NOT LIKE '%Mercado Prueba%' ",
        "         AND NOM_MERCADO NOT LIKE '%Mercado de Prueba%' ",
        "     ORDER BY ",
        "         NOM_MERCADO",
        " ) MERCADOS ",
        " WHERE ",
        "     EMPRESAS.ARE_ESP_SECUE = MERCADOS.ARE_ESP_SECUE",
        "     AND (EMPRESAS.ARE_ESP_SECUE = :EMPRESA_ARG OR 0 = :EMPRESA_ARG) ",
        ")",
        "UNION ",
        "(",
        " SELECT EMPRESAS.ARE_ESP_SECUE,",
        "        EMPRESAS.ARE_ESP_NOMBRE,",
        "        EMPRESAS.SERVICIO,",
        "        MERCADOS.ID_MERCADO,",
        "        MERCADOS.NOM_MERCADO ",
        " FROM ",
        " (",
        "     SELECT DISTINCT EMP.ARE_ESP_SECUE,",
        "            EMP.ARE_ESP_NOMBRE,",
        "            'ENERGIA' SERVICIO ",
        "     FROM ",
        "           RUPS.ARE_ESP_EMPRESAS EMP,",
        "           RUPS.ARE_SEES_SERESP ROM,",
        "           RUPS.ARE_NESP_NATESP NES,",
        "           RUPS.ARE_ACES_ACTESP ACT ",
        "     WHERE ",
        "           ROM.ARE_ESP_SECUE = EMP.ARE_ESP_SECUE",
        "           AND ROM.ARE_ESP_SECUE = NES.ARE_ESP_SECUE",
        "           AND ROM.ARE_ESP_SECUE = ACT.ARE_ESP_SECUE",
        "           AND EMP.ARE_ESP_SECUE < 99900",
        "           AND ROM.ARE_SEES_ESTADO = 'O'",
        "           AND NES.ARE_NESP_ESTADO = 'O'",
        "           AND ACT.ARE_ACES_ESTADO = 'O'",
        "           AND EMP.ARE_ESP_ACTUALIZA IS NOT NULL",
        "           AND EMP.ARE_ESP_ESTACT = 'A'",
        "           AND EMP.ARE_ESP_SECUE_CREG <> 0 ",
        "     GROUP BY ",
        "              EMP.ARE_ESP_SECUE,",
        "              EMP.ARE_ESP_NOMBRE,",
        "              EMP.ARE_ESP_ACTUALIZA,",
        "              EMP.ARE_ESP_ESTACT,",
        "              EMP.ARE_ESP_SECUE_CREG ",
        "     UNION ",
        "     SELECT ARE_ESP_SECUE,",
        "            ARE_ESP_NOMBRE,",
        "            'ENERGIA' SERVICIO ",
        "     FROM ",
        "         RUPS.ARE_ESP_EMPRESAS",
        "     WHERE ARE_ESP_SECUE = 44278",
        " ) EMPRESAS ",
        " LEFT JOIN ",
        " (",
        "     SELECT ",
        "         DISTINCT ID_MERCADO,",
        "         ARE_ESP_SECUE,",
        "         NOM_MERCADO,",
        "         ESTADO ",
        "     FROM ",
        "         CARG_COMERCIAL_E.MERCADO_EMPRESA ",
        "     WHERE ",
        "         ESTADO = 'A'",
        "         AND NOM_MERCADO NOT LIKE '%Mercado Prueba%' ",
        "         AND NOM_MERCADO NOT LIKE '%Mercado de Prueba%' ",
        "     ORDER BY ",
        "         NOM_MERCADO",
        " ) MERCADOS ",
        " ON ",
        "     EMPRESAS.ARE_ESP_SECUE = MERCADOS.ARE_ESP_SECUE ",
        " WHERE ",
        "     MERCADOS.ARE_ESP_SECUE IS NULL",
        ")",
        ")",
        "WHERE ARE_ESP_SECUE = :EMPRESA_ARG OR 0 = :EMPRESA_ARG"
    ]
}